<div align="center">

# cursor-2api ğŸš€

**å°† Cursor.com ç½‘é¡µç‰ˆè½¬åŒ–ä¸º OpenAI æ ‡å‡† API çš„è§£å†³æ–¹æ¡ˆ**

![ç‰ˆæœ¬](https://img.shields.io/badge/version-v3.1-blue)
![åè®®](https://img.shields.io/badge/license-Apache%202.0-green)
![æŠ€æœ¯æ ˆ](https://img.shields.io/badge/tech-FastAPI%20%7C%20Playwright%20%7C%20Docker-orange)
![è®¨è®º](https://img.shields.io/badge/discussions-welcome-purple)

</div>

> "æˆ‘ä»¬å¹¶éåœ¨åˆ›é€ é­”æ³•ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨ç”¨ä»£ç æ­ç¤ºæ—©å·²å­˜åœ¨çš„å¯èƒ½æ€§ã€‚æ­£å¦‚é»‘å®¢ç²¾ç¥çš„æœ¬è´¨â€”â€”ä¸æ˜¯ç ´åï¼Œè€Œæ˜¯ç”¨ä¸€ç§å‰æ‰€æœªæœ‰çš„æ–¹å¼ï¼Œè®©ç³»ç»Ÿå±•ç°å‡ºå®ƒè¢«è®¾è®¡æ—¶æœªæ›¾é¢„æ–™åˆ°çš„ç¾ä¸½ã€‚"

---

## âœ¨ é¡¹ç›®ç®€ä»‹

`cursor-2api` æ˜¯ä¸€ä¸ªåˆ›æ–°çš„ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆï¼Œå®ƒé€šè¿‡æµè§ˆå™¨è‡ªåŠ¨åŒ–æŠ€æœ¯å°† Cursor.com çš„ç½‘é¡µèŠå¤©ç•Œé¢è½¬åŒ–ä¸ºæ ‡å‡†çš„ OpenAI API æ ¼å¼ã€‚

ç”±äº Cursor å®˜æ–¹æœªæä¾›å…¬å¼€çš„ API æ¥å£ï¼Œæœ¬é¡¹ç›®é€šè¿‡è‡ªåŠ¨åŒ–æµè§ˆå™¨æ“ä½œï¼Œæ¨¡æ‹ŸçœŸå®ç”¨æˆ·è¡Œä¸ºï¼Œè®©ä½ èƒ½å¤Ÿä»¥æ ‡å‡† OpenAI API çš„æ–¹å¼è°ƒç”¨ Cursor èƒŒåçš„å¼ºå¤§ AI æ¨¡å‹ï¼ˆåŒ…æ‹¬ GPT-4oã€Claude 3.5 Sonnet ç­‰ï¼‰ã€‚

### ğŸ¯ æ ¸å¿ƒä»·å€¼

- **æ— ç¼é›†æˆ**: 100% å…¼å®¹ OpenAI API æ ¼å¼ï¼Œå¯ç›´æ¥æ¥å…¥ä»»ä½•æ”¯æŒ OpenAI çš„ç¬¬ä¸‰æ–¹åº”ç”¨
- **æ¨¡å‹å¤šæ ·æ€§**: æ”¯æŒ Cursor æä¾›çš„æ‰€æœ‰å¯ç”¨æ¨¡å‹
- **é›¶é…ç½®éƒ¨ç½²**: æä¾› Docker ä¸€é”®éƒ¨ç½²æ–¹æ¡ˆ
- **å®æ—¶æµå¼å“åº”**: å®Œæ•´æ”¯æŒ Server-Sent Events (SSE) æµå¼ä¼ è¾“

---

## ğŸ—ï¸ æ¶æ„åŸç†

### æ ¸å¿ƒå·¥ä½œæµç¨‹

```mermaid
sequenceDiagram
    participant C as Client
    participant F as FastAPI
    participant P as Playwright
    participant B as Browser
    participant S as Cursor Server

    C->>F: å‘é€ OpenAI æ ¼å¼è¯·æ±‚
    F->>P: å¤„ç†å¹¶å‡†å¤‡ Payload
    P->>B: æ³¨å…¥æ‹¦æˆªè„šæœ¬
    B->>S: å‘é€ä¿®æ”¹åçš„è¯·æ±‚
    S->>B: è¿”å›æµå¼å“åº”
    B->>P: é€šè¿‡é˜Ÿåˆ—å®æ—¶è½¬å‘
    P->>F: è½¬æ¢ä¸º SSE æ ¼å¼
    F->>C: æµå¼è¿”å›å“åº”
```

### å…³é”®æŠ€æœ¯ç‚¹

1. **æµè§ˆå™¨è‡ªåŠ¨åŒ–**: ä½¿ç”¨ Playwright æ§åˆ¶æ— å¤´æµè§ˆå™¨è®¿é—® Cursor ç½‘é¡µ
2. **è¯·æ±‚æ‹¦æˆª**: é€šè¿‡æ³¨å…¥çš„ JavaScript è„šæœ¬ä¿®æ”¹æµè§ˆå™¨ fetch è¯·æ±‚
3. **å®æ—¶æµå¤„ç†**: åˆ©ç”¨ asyncio.Queue å®ç°æµè§ˆå™¨åˆ°åç«¯çš„å®æ—¶æ•°æ®ä¼ é€’
4. **æ ¼å¼è½¬æ¢**: å°† Cursor çš„å“åº”æ ¼å¼è½¬æ¢ä¸ºæ ‡å‡† OpenAI API æ ¼å¼

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
cursor-2api/
â”œâ”€â”€ .env                    # ç¯å¢ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ .env.example           # ç¯å¢ƒé…ç½®æ¨¡æ¿
â”œâ”€â”€ Dockerfile             # Docker æ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml     # Docker Compose é…ç½®
â”œâ”€â”€ main.py                # FastAPI åº”ç”¨å…¥å£
â”œâ”€â”€ nginx.conf             # Nginx åå‘ä»£ç†é…ç½®
â”œâ”€â”€ requirements.txt       # Python ä¾èµ–åˆ—è¡¨
â””â”€â”€ app/                   # æ ¸å¿ƒåº”ç”¨ä»£ç 
    â”œâ”€â”€ core/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ config.py      # é…ç½®ç®¡ç†
    â”œâ”€â”€ providers/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ base_provider.py    # Provider åŸºç±»
    â”‚   â”œâ”€â”€ cursor_provider.py  # Cursor æä¾›å•†å®ç°
    â”‚   â””â”€â”€ fetch_override.js   # è¯·æ±‚æ‹¦æˆªè„šæœ¬
    â””â”€â”€ utils/
        â””â”€â”€ sse_utils.py   # SSE å·¥å…·å‡½æ•°
```

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### ç¯å¢ƒè¦æ±‚

- Docker & Docker Compose
- è‡³å°‘ 2GB å¯ç”¨å†…å­˜
- ç¨³å®šçš„ç½‘ç»œè¿æ¥

### éƒ¨ç½²æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/lzA6/cursor-2api.git
cd cursor-2api
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```ini
# ====================================================================
# cursor-2api é…ç½®æ–‡ä»¶
# ====================================================================

# API è®¿é—®å¯†é’¥ï¼ˆå»ºè®®è®¾ç½®ä¸ºå¤æ‚å­—ç¬¦ä¸²ï¼‰
API_MASTER_KEY=your-secret-key-here

# æœåŠ¡ç«¯å£
NGINX_PORT=8088
```

#### 3. å¯åŠ¨æœåŠ¡

```bash
docker-compose up -d
```

#### 4. éªŒè¯éƒ¨ç½²

```bash
curl -X POST http://localhost:8088/v1/chat/completions \
  -H "Authorization: Bearer your-secret-key-here" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "openai/gpt-4o",
    "messages": [
      {
        "role": "user",
        "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"
      }
    ],
    "stream": true
  }'
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆè¯¦è§£

| æŠ€æœ¯ç»„ä»¶ | ä½œç”¨ | å­¦ä¹ èµ„æº | å¤æ‚åº¦ |
|---------|------|----------|--------|
| **FastAPI** | æ„å»ºé«˜æ€§èƒ½ Web API æœåŠ¡ | [å®˜æ–¹æ–‡æ¡£](https://fastapi.tiangolo.com/) | â­â­â˜†â˜†â˜† |
| **Playwright** | æµè§ˆå™¨è‡ªåŠ¨åŒ–ä¸æ§åˆ¶ | [Playwright Python](https://playwright.dev/python/) | â­â­â­â˜†â˜† |
| **Docker** | åº”ç”¨å®¹å™¨åŒ–ä¸éƒ¨ç½² | [Docker æ•™ç¨‹](https://docs.docker.com/get-started/) | â­â­â­â˜†â˜† |
| **Nginx** | åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡ | [Nginx æŒ‡å—](https://nginx.org/en/docs/) | â­â­â˜†â˜†â˜† |
| **Asyncio** | å¼‚æ­¥ç¼–ç¨‹ä¸å¹¶å‘å¤„ç† | [Python Asyncio](https://docs.python.org/3/library/asyncio.html) | â­â­â­â­â˜† |
| **JavaScript Injection** | æµè§ˆå™¨è¯·æ±‚æ‹¦æˆªä¸ä¿®æ”¹ | [MDN Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) | â­â­â­â­â˜† |

---

## ğŸ“Š åŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ç°åŠŸèƒ½

- [x] OpenAI API æ ‡å‡†å…¼å®¹
- [x] å¤šæ¨¡å‹æ”¯æŒï¼ˆGPT-4oã€Claude 3.5 Sonnet ç­‰ï¼‰
- [x] æµå¼å“åº”ï¼ˆServer-Sent Eventsï¼‰
- [x] è‡ªåŠ¨ä¸Šä¸‹æ–‡ç®¡ç†
- [x] åŠ¨æ€ Token è®¡æ•°
- [x] ä¼šè¯æŒä¹…åŒ–
- [x] Docker å®¹å™¨åŒ–éƒ¨ç½²

### ğŸš§ å¾…å®ç°åŠŸèƒ½

- [ ] å¤šè´¦æˆ·è½®æ¢
- [ ] è¯·æ±‚é¢‘ç‡é™åˆ¶
- [ ] ä½¿ç”¨é‡ç»Ÿè®¡
- [ ] Web ç®¡ç†ç•Œé¢
- [ ] å¥åº·æ£€æŸ¥ç«¯ç‚¹

---

## âš–ï¸ ä¼˜åŠ¿ä¸å±€é™

### âœ… ä¼˜åŠ¿

1. **æˆæœ¬æ•ˆç›Š**: å…è´¹ä½¿ç”¨ Cursor æä¾›çš„é¡¶çº§ AI æ¨¡å‹
2. **å…¼å®¹æ€§å¼º**: æ— ç¼å¯¹æ¥ç°æœ‰ OpenAI ç”Ÿæ€åº”ç”¨
3. **æ™ºèƒ½ä¸Šä¸‹æ–‡**: è‡ªåŠ¨æ£€æµ‹å’Œç®¡ç†å¯¹è¯ä¸Šä¸‹æ–‡é™åˆ¶
4. **æŒç»­æ›´æ–°**: éš Cursor å®˜ç½‘æ›´æ–°è€Œè‡ªåŠ¨è·å–æ–°åŠŸèƒ½
5. **å¼€æºé€æ˜**: å®Œæ•´æºä»£ç ï¼Œå¯è‡ªå®šä¹‰æ‰©å±•

### âš ï¸ å±€é™ä¸é£é™©

1. **ä¾èµ–ç½‘ç«™ç»“æ„**: Cursor å‰ç«¯æ›´æ–°å¯èƒ½å¯¼è‡´æœåŠ¡ä¸­æ–­
2. **æ€§èƒ½å¼€é”€**: æµè§ˆå™¨è‡ªåŠ¨åŒ–ç›¸æ¯”åŸç”Ÿ API æœ‰é¢å¤–èµ„æºæ¶ˆè€—
3. **æœåŠ¡æ¡æ¬¾**: å¯èƒ½è¿å Cursor çš„ä½¿ç”¨åè®®
4. **åŠŸèƒ½é™åˆ¶**: ä»…æ”¯æŒèŠå¤©åŠŸèƒ½ï¼Œä¸æ”¯æŒå›¾åƒç”Ÿæˆç­‰å…¶ä»–èƒ½åŠ›

---

## ğŸ”® å‘å±•è·¯çº¿å›¾

### è¿‘æœŸç›®æ ‡
- å¢å¼ºé”™è¯¯å¤„ç†å’Œè‡ªåŠ¨æ¢å¤æœºåˆ¶
- æ·»åŠ è¯·æ±‚é˜Ÿåˆ—å’Œé™æµåŠŸèƒ½
- å®ç°é…ç½®çƒ­é‡è½½

### ä¸­æœŸè§„åˆ’  
- æ”¯æŒå¤šæä¾›å•†æ¶æ„ï¼ˆPoeã€Claude å®˜ç½‘ç­‰ï¼‰
- å¼€å‘ Web ç®¡ç†é¢æ¿
- ä¼˜åŒ–èµ„æºä½¿ç”¨æ•ˆç‡

### é•¿æœŸæ„¿æ™¯
- ä¸€é”®äº‘å¹³å°éƒ¨ç½²
- æ™ºèƒ½æ¨¡å‹è·¯ç”±
- ç¤¾åŒºé©±åŠ¨çš„åŠŸèƒ½å¼€å‘

---

## ğŸ¤– æŠ€æœ¯æ·±åº¦è§£æ

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

#### 1. Playwright ç®¡ç†å™¨ (`cursor_provider.py`)
```python
class PlaywrightManager:
    """ç®¡ç†æµè§ˆå™¨å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸ"""
    async def get_page(self) -> Page:
        # è·å–æˆ–åˆ›å»ºæµè§ˆå™¨é¡µé¢
        pass
    
    async def cleanup(self):
        # æ¸…ç†èµ„æº
        pass
```

#### 2. è¯·æ±‚æ‹¦æˆªæœºåˆ¶ (`fetch_override.js`)
```javascript
// æ‹¦æˆªå¹¶ä¿®æ”¹ fetch è¯·æ±‚
const originalFetch = window.fetch;
window.fetch = async function(...args) {
    if (args[0].includes('/chat/completions')) {
        // ä¿®æ”¹è¯·æ±‚ä½“å¹¶å¤„ç†å“åº”æµ
        return handleChatCompletion(...args);
    }
    return originalFetch.apply(this, args);
};
```

#### 3. æµå¼å“åº”å¤„ç† (`sse_utils.py`)
```python
async def stream_generator(queue: asyncio.Queue):
    """ä»é˜Ÿåˆ—ç”Ÿæˆ SSE æµ"""
    while True:
        chunk = await queue.get()
        if chunk is None:  # ç»“æŸä¿¡å·
            break
        yield f"data: {chunk}\n\n"
```

### æ‰©å±•å¼€å‘æŒ‡å—

è¦æ·»åŠ æ–°çš„æä¾›å•†ï¼š

1. ç»§æ‰¿ `BaseProvider` ç±»
2. å®ç° `chat_completion` æ–¹æ³•
3. æ·»åŠ å¯¹åº”çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–é€»è¾‘
4. æ³¨å†Œåˆ°æä¾›å•†å·¥å‚

---

## ğŸ“œ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ **Apache License 2.0** åè®®ã€‚

**ä½ å¯ä»¥ï¼š**
- å•†ä¸šä½¿ç”¨
- ä¿®æ”¹ä»£ç 
- åˆ†å‘å‰¯æœ¬
- ä¸“åˆ©æˆæƒ

**ä½ éœ€è¦ï¼š**
- åŒ…å«ç‰ˆæƒå£°æ˜
- å£°æ˜ä¿®æ”¹å†…å®¹

**ä½ ä¸èƒ½ï¼š**
- ä½¿ç”¨å•†æ ‡
- è¿½ç©¶è´£ä»»

å®Œæ•´åè®®å†…å®¹è¯·å‚é˜… [LICENSE](./LICENSE) æ–‡ä»¶ã€‚

---

## ğŸ¤ è´¡çŒ®ä¸æ”¯æŒ

### é—®é¢˜åé¦ˆ
å¦‚é‡é—®é¢˜ï¼Œè¯·é€šè¿‡ [GitHub Issues](https://github.com/lzA6/cursor-2api/issues) æäº¤ã€‚

### æŠ€æœ¯è®¨è®º
æ¬¢è¿åŠ å…¥ [Discussions](https://github.com/lzA6/cursor-2api/discussions) å‚ä¸æŠ€æœ¯äº¤æµã€‚

### å¼€å‘è´¡çŒ®
1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. å‘èµ· Pull Request

---

## ğŸ’­ ç»“è¯­

> æŠ€æœ¯æ˜¯ä¸­ç«‹çš„å·¥å…·ï¼Œå…³é”®åœ¨äºæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒã€‚è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†å¦‚ä½•é€šè¿‡åˆ›æ–°æ€ç»´çªç ´æŠ€æœ¯é™åˆ¶ï¼Œè®©æ›´å¤šäººèƒ½å¤Ÿæ¥è§¦åˆ°å…ˆè¿›çš„ AI æŠ€æœ¯ã€‚
>
> æˆ‘ä»¬é¼“åŠ±è´Ÿè´£ä»»çš„ä½¿ç”¨æ–¹å¼ï¼Œå°Šé‡æœåŠ¡æä¾›å•†çš„æƒç›Šï¼ŒåŒæ—¶æ¨åŠ¨æŠ€æœ¯çš„å¼€æ”¾å’Œæ™®åŠã€‚
>
> å¸Œæœ›è¿™ä¸ªé¡¹ç›®èƒ½å¯å‘ä½ æ¢ç´¢æ›´å¤šçš„æŠ€æœ¯å¯èƒ½æ€§ï¼Œç”¨ä»£ç åˆ›é€ ä»·å€¼ã€‚

**Happy Coding! ğŸš€**

---
